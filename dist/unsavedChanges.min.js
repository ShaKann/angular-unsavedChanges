(function(a,b){if(typeof define==="function"&&define.amd){define(["angular"],b)}else{if(typeof module!=="undefined"&&typeof module.exports==="object"){module.exports=b(require("angular"))}else{return b(a.angular)}}}(this,function(b){var a="resettable";var c=b.module(a,[]);c.value("linkLoggerOptions",{enabled:true});c.directive("resettable",["$parse","$compile","$rootScope",function(g,f,e){return{restrict:"A",link:function d(p,j,m,h){var k,n,o;m.$observe("ngModel",function(q){n=g(m.ngModel);k=n.assign;o=n(p)});var l=function(){k(p,o)};j.on("resetResettables",l);var i=p.$on("resetResettables",l);p.$on("$destroy",i)}}}]);return a}));(function(a,b){if(typeof define==="function"&&define.amd){define(["angular"],b)}else{if(typeof module!=="undefined"&&typeof module.exports==="object"){module.exports=b(require("angular"))}else{return b(a.angular)}}}(this,function(b){var a="unsavedChanges";var c=b.module(a,["resettable"]);c.provider("unsavedWarningsConfig",function(){var i=this;var h=false;var e=true;var g=["$locationChangeStart","$stateChangeStart"];var f="You will lose unsaved changes if you leave this page";var d="You will lose unsaved changes if you reload this page";Object.defineProperty(i,"navigateMessage",{get:function(){return f},set:function(j){f=j}});Object.defineProperty(i,"reloadMessage",{get:function(){return d},set:function(j){d=j}});Object.defineProperty(i,"useTranslateService",{get:function(){return e},set:function(j){e=!!(j)}});Object.defineProperty(i,"routeEvent",{get:function(){return g},set:function(j){if(typeof j==="string"){j=[j]}g=j}});Object.defineProperty(i,"logEnabled",{get:function(){return h},set:function(j){h=!!(j)}});this.$get=["$injector",function(k){function l(m){if(k.has("$translate")&&e){return k.get("$translate").instant(m)}else{return false}}var j={log:function(){if(console.log&&h&&arguments.length){var m=[].slice.call(arguments);if(typeof console.log==="object"){log.apply.call(console.log,console,m)}else{console.log.apply(console,m)}}}};Object.defineProperty(j,"useTranslateService",{get:function(){return e}});Object.defineProperty(j,"reloadMessage",{get:function(){return l(d)||d}});Object.defineProperty(j,"navigateMessage",{get:function(){return l(f)||f}});Object.defineProperty(j,"routeEvent",{get:function(){return g}});Object.defineProperty(j,"logEnabled",{get:function(){return h}});return j}]});c.service("unsavedWarningSharedService",["$rootScope","unsavedWarningsConfig","$injector","$window",function(m,f,n,g){var l=this;var d=[];var j=true;var h=[];this.allForms=function(){return d};function k(){j=true;b.forEach(d,function(p,o){f.log("Form : "+p.$name+" dirty : "+p.$dirty);if(p.$dirty){j=false}});return j}this.init=function(o){if(d.length===0){i()}f.log("Registering form",o);d.push(o)};this.removeForm=function(p){var o=d.indexOf(p);if(o===-1){return}d.splice(o,1);f.log("Removing form from watch list",p);if(d.length===0){e()}};function e(){f.log("No more forms, tearing down");b.forEach(h,function(o){o()});h=[];g.onbeforeunload=null}this.confirmExit=function(){if(!k()){return f.reloadMessage}m.$broadcast("resetResettables");e()};function i(){f.log("Setting up");g.onbeforeunload=l.confirmExit;var o=f.routeEvent;b.forEach(o,function(p){var q=m.$on(p,function(s,r,t){f.log("user is moving with "+p);if(!k()){f.log("a form is dirty");if(!confirm(f.navigateMessage)){f.log("user wants to cancel leaving");s.preventDefault()}else{f.log("user doesn't care about loosing stuff");m.$broadcast("resetResettables")}}else{f.log("all forms are clean")}});h.push(q)})}}]);c.directive("unsavedWarningClear",["unsavedWarningSharedService",function(d){return{scope:{},require:"^form",priority:10,link:function(g,f,e,h){f.bind("click",function(i){h.$setPristine()})}}}]);c.directive("unsavedWarningForm",["unsavedWarningSharedService","$rootScope",function(e,d){return{scope:{},require:"^form",link:function(h,g,f,j){var i=0;while(g[0].tagName!=="FORM"&&i<3){i++;g=g.parent()}if(i>=3){throw ("unsavedWarningForm must be inside a form element")}e.init(j);g.bind("submit",function(k){if(j.$valid){j.$setPristine()}});g.bind("reset",function(k){k.preventDefault();var l=b.element(g[0].querySelector("[resettable]"));if(l.length){h.$apply(l.triggerHandler("resetResettables"))}j.$setPristine()});h.$on("$destroy",function(){e.removeForm(j)})}}}]);return a}));